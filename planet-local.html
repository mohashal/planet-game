<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ØªØ­Ø¯ÙŠ Ù…Ø³ØªÙƒØ´Ù Ø§Ù„ÙØ¶Ø§Ø¡ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©</title>
    <style>
        :root {
            --space-dark: #00021a;
            --neon-blue: #00d4ff;
            --success: #00ffcc;
            --error: #ff3366;
            --gold: #ffd700;
        }

        /* Ù…Ù†Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ ÙˆØ§Ù„ØªØ¯Ø®Ù„ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø³Ø­Ø¨ */
        * { 
            user-select: none; 
            -webkit-user-drag: none; 
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0; min-height: 100vh; background: var(--space-dark);
            color: white; font-family: 'Segoe UI', Tahoma, sans-serif;
            display: flex; flex-direction: column; align-items: center;
            overflow: hidden; touch-action: none;
        }

        .star-field { position: fixed; inset: 0; z-index: -1; background: radial-gradient(circle at center, #001233 0%, #00021a 100%); }

        .audio-controls {
            position: fixed; top: 15px; left: 15px; z-index: 2000;
            background: rgba(255,255,255,0.1); padding: 10px; border-radius: 50%;
            cursor: pointer; border: 1px solid var(--neon-blue); width: 40px; height: 40px;
            display: flex; justify-content: center; align-items: center;
        }

        .stats-bar {
            display: flex; gap: 20px; margin: 15px 0; z-index: 10;
            background: rgba(255, 255, 255, 0.05); padding: 10px 25px; 
            border-radius: 50px; border: 1px solid var(--neon-blue);
        }

        .progress-container { width: 85%; max-width: 500px; height: 10px; background: rgba(255,255,255,0.1); border-radius: 10px; margin-bottom: 10px; overflow: hidden; }
        #progress-fill { width: 0%; height: 100%; background: var(--success); transition: 0.5s cubic-bezier(0.4, 0, 0.2, 1); }

        h1 { margin: 5px; font-size: 1.5rem; text-shadow: 0 0 10px var(--neon-blue); }

        .solar-system {
            display: flex; flex-wrap: wrap; justify-content: center; gap: 12px;
            width: 95%; max-width: 900px; padding: 20px;
            background: rgba(255, 255, 255, 0.03); border-radius: 25px; border: 1px solid rgba(255,255,255,0.1);
        }

        .sun { width: 65px; height: 65px; background: radial-gradient(circle, #ffcc00, #ff4400); border-radius: 50%; box-shadow: 0 0 30px #ff6600; flex-shrink: 0; }
        .drop-zone { width: 60px; height: 60px; border: 2px dashed rgba(255, 255, 255, 0.2); border-radius: 50%; transition: 0.3s; }
        .drop-zone.detecting { background: rgba(0, 212, 255, 0.2); border-color: var(--neon-blue); transform: scale(1.1); }

        .pool-container {
            margin-top: auto; margin-bottom: 30px; width: 95%; max-width: 850px;
            background: rgba(255, 255, 255, 0.07); border-radius: 20px; padding: 15px;
            display: flex; flex-wrap: wrap; justify-content: center; gap: 12px;
        }

        .planet-slot { width: 55px; height: 55px; background: rgba(0,0,0,0.3); border-radius: 50%; }

        .planet { 
            width: 55px; height: 55px; border-radius: 50%; position: absolute; 
            cursor: grab; z-index: 100; display: flex; justify-content: center; align-items: center;
        }
        
        .planet-img { 
            width: 100%; height: 100%; border-radius: 50%; background-size: cover !important; 
            animation: rotatePlanet 20s linear infinite; box-shadow: inset -5px -5px 12px rgba(0,0,0,0.7); 
        }
        @keyframes rotatePlanet { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        
        .planet span { position: absolute; bottom: -22px; font-size: 10px; background: rgba(0,0,0,0.8); padding: 2px 6px; border-radius: 4px; pointer-events: none; white-space: nowrap; }
        .planet.returning { transition: all 0.5s ease-out; }

        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.92);
            display: none; justify-content: center; align-items: center;
            z-index: 5000; backdrop-filter: blur(15px);
        }
        .modal-content {
            background: #000; padding: 40px; border-radius: 30px; border: 1px solid var(--neon-blue);
            text-align: center; width: 85%; max-width: 380px; box-shadow: 0 0 30px var(--neon-blue);
        }
        .rank-tag { color: var(--gold); font-size: 1.5rem; font-weight: bold; margin: 20px 0; display: block; }
        .retry-btn { background: var(--neon-blue); color: black; border: none; padding: 12px 40px; border-radius: 50px; font-weight: bold; cursor: pointer; font-size: 1.1rem; }

        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
    </style>
</head>
<body>

    <div class="star-field"></div>

    <div class="audio-controls" onclick="toggleMusic()"><span id="mute-icon">ğŸ”‡</span></div>

    <div class="stats-bar">
        <div class="stat-item">Ø§Ù„ØªÙ‚Ø¯Ù…: <span id="percent-text">0%</span></div>
        <div class="stat-item">Ø§Ù„Ø²Ù…Ù†: <span id="timer-text">0</span> Ø«</div>
    </div>

    <div class="progress-container"><div id="progress-fill"></div></div>

    <h1>ØªØ­Ø¯ÙŠ Ù…Ø¯Ø§Ø±Ø§Øª Ø§Ù„ÙƒÙˆØ§ÙƒØ¨</h1>

    <div class="solar-system">
        <div class="sun"></div>
        <div class="drop-zone" data-order="1"></div>
        <div class="drop-zone" data-order="2"></div>
        <div class="drop-zone" data-order="3"></div>
        <div class="drop-zone" data-order="4"></div>
        <div class="drop-zone" data-order="5"></div>
        <div class="drop-zone" data-order="6"></div>
        <div class="drop-zone" data-order="7"></div>
        <div class="drop-zone" data-order="8"></div>
    </div>

    <div class="pool-container" id="pool"></div>

    <div class="modal-overlay" id="finish-modal">
        <div class="modal-content">
            <h2 style="color: var(--success); margin: 0;">Ù…Ù‡Ù…Ø© Ù†Ø§Ø¬Ø­Ø©! ğŸš€</h2>
            <p>ØªÙ… ØªØ±ØªÙŠØ¨ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ù…Ø³ÙŠ ÙÙŠ <span id="final-time" style="color:var(--neon-blue)">0</span> Ø«Ø§Ù†ÙŠØ©.</p>
            <span class="rank-tag" id="final-rank"></span>
            <button class="retry-btn" onclick="location.reload()">Ø§Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</button>
        </div>
    </div>

    <audio id="bg-music" loop src="assets/audio/bg.mp3"></audio>
    <audio id="snd-correct" src="assets/audio/correct.mp3"></audio>
    <audio id="snd-wrong" src="assets/audio/wrong.mp3"></audio>

    <script>
        const planetData = [
            { id: "1", name: "Ø¹Ø·Ø§Ø±Ø¯", img: "assets/images/1.jpg" },
            { id: "2", name: "Ø§Ù„Ø²Ù‡Ø±Ø©", img: "assets/images/2.jpg" },
            { id: "3", name: "Ø§Ù„Ø£Ø±Ø¶", img: "assets/images/3.jpg" },
            { id: "4", name: "Ø§Ù„Ù…Ø±ÙŠØ®", img: "assets/images/4.jpg" },
            { id: "5", name: "Ø§Ù„Ù…Ø´ØªØ±ÙŠ", img: "assets/images/5.jpg" },
            { id: "6", name: "Ø²Ø­Ù„", img: "assets/images/6.jpg" },
            { id: "7", name: "Ø£ÙˆØ±Ø§Ù†ÙˆØ³", img: "assets/images/7.jpg" },
            { id: "8", name: "Ù†Ø¨ØªÙˆÙ†", img: "assets/images/8.jpg" }
        ];

        let correctCount = 0, seconds = 0, timerActive = false, timerInterval;
        const bgMusic = document.getElementById('bg-music');
        bgMusic.volume = 0.2;

        // Ø¯Ø§Ù„Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª Ø§Ù„Ù…ØµØ­Ø­Ø© (ØªØµÙÙŠØ± Ø§Ù„ÙˆÙ‚Øª Ù‚Ø¨Ù„ Ø§Ù„ØªØ´ØºÙŠÙ„)
        function playSfx(id) {
            const sound = document.getElementById(id);
            if (sound) {
                sound.pause();
                sound.currentTime = 0; // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØµÙˆØª Ù„Ù„Ø¨Ø¯Ø§ÙŠØ©
                sound.play().catch(() => {});
            }
            if(id === 'snd-wrong' && navigator.vibrate) navigator.vibrate(200);
        }

        function toggleMusic() {
            if (bgMusic.paused) { bgMusic.play(); document.getElementById('mute-icon').textContent = "ğŸ”Š"; }
            else { bgMusic.pause(); document.getElementById('mute-icon').textContent = "ğŸ”‡"; }
        }

        function launchConfetti() {
            const canvas = document.createElement('canvas');
            canvas.style.position = 'fixed'; canvas.style.inset = 0; canvas.style.pointerEvents = 'none'; canvas.style.zIndex = '6000';
            document.body.appendChild(canvas);
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            let p = Array.from({length: 120}, () => ({
                x: Math.random()*canvas.width, y: -20, s: Math.random()*5+2, 
                c: ['#00d4ff','#ffd700','#ff3366','#00ffcc'][Math.floor(Math.random()*4)],
                v: Math.random()*4+3
            }));
            function anim() {
                ctx.clearRect(0,0,canvas.width,canvas.height);
                p.forEach(i => { i.y += i.v; ctx.fillStyle = i.c; ctx.beginPath(); ctx.arc(i.x,i.y,i.s,0,6.28); ctx.fill(); });
                if(p[0].y < canvas.height + 50) requestAnimationFrame(anim); else canvas.remove();
            }
            anim();
        }

        // ØªÙˆØ²ÙŠØ¹ Ø§Ù„ÙƒÙˆØ§ÙƒØ¨ Ø¹Ø´ÙˆØ§Ø¦ÙŠØ§Ù‹
        [...planetData].sort(() => Math.random() - 0.5).forEach((data) => {
            const slot = document.createElement('div');
            slot.className = 'planet-slot';
            document.getElementById('pool').appendChild(slot);

            const planet = document.createElement('div');
            planet.className = 'planet';
            planet.id = data.id;
            planet.innerHTML = `<div class="planet-img" style="background: url(${data.img})"></div><span>${data.name}</span>`;
            
            setTimeout(() => {
                const rect = slot.getBoundingClientRect();
                planet.style.left = rect.left + 'px';
                planet.style.top = rect.top + 'px';
                planet.dataset.homeLeft = rect.left;
                planet.dataset.homeTop = rect.top;
            }, 600);

            document.body.appendChild(planet);
            makeDraggable(planet);
        });

        function makeDraggable(el) {
            let p1=0, p2=0, p3=0, p4=0;

            const start = (e) => {
                e.preventDefault();
                if(!timerActive) {
                    timerActive = true;
                    bgMusic.play().then(() => document.getElementById('mute-icon').textContent = "ğŸ”Š").catch(()=>{});
                    timerInterval = setInterval(() => { seconds++; document.getElementById('timer-text').textContent = seconds; }, 1000);
                }
                el.classList.remove('returning');
                const ev = e.touches ? e.touches[0] : e;
                p3 = ev.clientX; p4 = ev.clientY;
                document.onmousemove = move; document.ontouchmove = move;
                document.onmouseup = end; document.ontouchend = end;
                el.style.zIndex = 1000;
            };

            const move = (e) => {
                const ev = e.touches ? e.touches[0] : e;
                p1 = p3 - ev.clientX; p2 = p4 - ev.clientY;
                p3 = ev.clientX; p4 = ev.clientY;
                el.style.top = (el.offsetTop - p2) + "px";
                el.style.left = (el.offsetLeft - p1) + "px";
                
                // ØªÙ„Ù…ÙŠØ­ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥ÙÙ„Ø§Øª
                const r = el.getBoundingClientRect();
                const cx = r.left + r.width/2, cy = r.top + r.height/2;
                document.querySelectorAll('.drop-zone').forEach(z => {
                    const zr = z.getBoundingClientRect();
                    if (cx > zr.left && cx < zr.right && cy > zr.top && cy < zr.bottom) z.classList.add('detecting');
                    else z.classList.remove('detecting');
                });
            };

            const end = () => {
                // ØªØµÙÙŠØ± Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… Ø­Ø¯ÙˆØ« Bug Ø§Ù„Ù€ Select
                document.onmousemove = null; document.ontouchmove = null;
                document.onmouseup = null; document.ontouchend = null;
                checkDrop(el);
            };

            el.onmousedown = start; el.ontouchstart = start;
        }

        function checkDrop(el) {
            const r = el.getBoundingClientRect();
            const cx = r.left + r.width/2, cy = r.top + r.height/2;
            let zone = null;

            document.querySelectorAll('.drop-zone').forEach(z => {
                z.classList.remove('detecting');
                const zr = z.getBoundingClientRect();
                if (cx > zr.left && cx < zr.right && cy > zr.top && cy < zr.bottom) zone = z;
            });

            if (zone && el.id === zone.dataset.order) {
                const zr = zone.getBoundingClientRect();
                el.style.left = (zr.left + (zr.width - 55)/2) + "px";
                el.style.top = (zr.top + (zr.height - 55)/2) + "px";
                el.onmousedown = el.ontouchstart = null; // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø³Ø­Ø¨ Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ø¬Ø§Ø­
                
                playSfx('snd-correct'); // ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª Ø§Ù„Ù…Ø­Ø¯Ø«
                
                correctCount++;
                document.getElementById('progress-fill').style.width = (correctCount/8)*100 + "%";
                document.getElementById('percent-text').textContent = Math.round((correctCount/8)*100) + "%";
                
                if (correctCount === 8) {
                    clearInterval(timerInterval);
                    launchConfetti();
                    document.getElementById('final-time').textContent = seconds;
                    document.getElementById('final-rank').textContent = seconds <= 25 ? "Ø±Ø§Ø¦Ø¯ ÙØ¶Ø§Ø¡ Ø£Ø³Ø·ÙˆØ±ÙŠ ğŸ–ï¸" : seconds <= 45 ? "Ù…Ø³ØªÙƒØ´Ù Ø®Ø¨ÙŠØ± ğŸš€" : "Ù…Ù„Ø§Ø­ ÙØ¶Ø§Ø¦ÙŠ ğŸ‘¨â€ğŸš€";
                    setTimeout(() => document.getElementById('finish-modal').style.display = 'flex', 600);
                }
            } else {
                if(zone) {
                    playSfx('snd-wrong');
                    zone.style.animation = "shake 0.4s";
                    setTimeout(() => zone.style.animation = "", 400);
                }
                el.classList.add('returning');
                el.style.left = el.dataset.homeLeft + 'px';
                el.style.top = el.dataset.homeTop + 'px';
                el.style.zIndex = 100;
            }
        }
    </script>
</body>
</html>