<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Ù…Ø³ØªÙƒØ´Ù Ø§Ù„ÙØ¶Ø§Ø¡ - Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Kufi+Arabic:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --space-dark: #00021a;
            --neon-blue: #00d4ff;
            --success: #00ffcc;
            --gold: #ffd700;
            --error: #ff3366;
            --sun-glow: rgba(255, 166, 0, 0.6);
        }

        * { user-select: none; -webkit-user-drag: none; box-sizing: border-box; }

        body {
            margin: 0; min-height: 100vh; background: var(--space-dark);
            color: white; font-family: 'Noto Kufi Arabic', sans-serif;
            display: flex; flex-direction: column; align-items: center;
            overflow: hidden; touch-action: none;
        }

        /* ÙÙ„Ø§Ø´ Ø§Ù„Ø§Ù†ÙØ¬Ø§Ø± Ø§Ù„Ø´Ù…Ø³ÙŠ */
        #solar-flare-overlay {
            position: fixed; inset: 0; background: white; z-index: 9999;
            opacity: 0; pointer-events: none; transition: opacity 0.3s;
        }

        /* Ø®Ù„ÙÙŠØ© Ø§Ù„Ù†Ø¬ÙˆÙ… Ø§Ù„Ù…Ø­Ø³Ù†Ø© Ù„Ù„Ø£Ø¯Ø§Ø¡ */
        .star-field {
            position: fixed; inset: 0; z-index: -1;
            perspective: 500px; background: radial-gradient(circle at center, #001233 0%, #00021a 100%);
        }

        .layer {
            position: absolute; top: 50%; left: 50%; width: 2px; height: 2px;
            border-radius: 50%; opacity: 0; will-change: transform;
            animation: fly 12s linear infinite;
        }

        .layer:nth-child(1) { box-shadow: 15vw 10vh #fff, -20vw -25vh #ddd, 35vw -5vh #fff; animation-delay: 0s; }
        .layer:nth-child(2) { box-shadow: -30vw 15vh #fff, 10vw -35vh #ccc, -5vw -15vh #fff; animation-delay: -4s; }
        .layer:nth-child(3) { box-shadow: 20vw -20vh #fff, -35vw 35vh #bbb, 25vw 15vh #fff; animation-delay: -8s; }

        @keyframes fly {
            0% { transform: translateZ(-1000px); opacity: 0; }
            20% { opacity: 1; }
            80% { opacity: 1; }
            100% { transform: translateZ(500px); opacity: 0; }
        }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ */
        #welcome-screen {
            position: fixed; inset: 0; background: var(--space-dark);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 7000; text-align: center; padding: 20px; transition: opacity 0.5s;
        }

        #astronaut-img {
            width: 140px; height: 140px; margin-bottom: 20px;
            animation: float 4s ease-in-out infinite;
        }
        #astronaut-img img { width: 100%; height: auto; filter: drop-shadow(0 0 10px var(--neon-blue)); }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(5deg); }
        }

        #welcome-text { font-size: 1.1rem; max-width: 450px; margin-bottom: 30px; line-height: 1.7; color: #e0e0e0; }

        #start-button {
            background: var(--neon-blue); color: black; border: none;
            padding: 16px 50px; border-radius: 50px; font-weight: bold;
            font-size: 1.1rem; cursor: pointer; font-family: inherit;
            box-shadow: 0 0 25px rgba(0, 212, 255, 0.4); transition: 0.3s;
        }
        #start-button:active { transform: scale(0.95); }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨ */
        .stats-bar {
            display: flex; gap: 20px; margin: 15px 0; z-index: 10;
            background: rgba(255, 255, 255, 0.05); padding: 10px 25px; 
            border-radius: 50px; border: 1px solid var(--neon-blue); font-size: 0.85rem;
        }

        .progress-container { width: 80%; max-width: 350px; height: 6px; background: rgba(255,255,255,0.1); border-radius: 10px; margin-bottom: 10px; overflow: hidden; }
        #progress-fill { width: 0%; height: 100%; background: var(--success); transition: 0.4s; }

        .solar-system {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;
            width: 95%; max-width: 450px; padding: 20px;
            background: rgba(255, 255, 255, 0.02); border-radius: 25px; border: 1px solid rgba(255,255,255,0.1);
            position: relative;
        }

        .sun { 
            grid-column: span 3; justify-self: center; width: 55px; height: 55px; 
            background: radial-gradient(circle, #ffcc00, #ff4400); border-radius: 50%; 
            box-shadow: 0 0 30px #ff6600, 0 0 60px var(--sun-glow); 
        }
        
        .drop-zone { 
            width: 52px; height: 52px; border: 2px dashed rgba(255, 255, 255, 0.15); 
            border-radius: 50%; justify-self: center; transition: 0.3s;
            background: rgba(255,255,255,0.02);
        }
        .drop-zone.detecting { border-color: var(--neon-blue); background: rgba(0, 212, 255, 0.1); transform: scale(1.1); }

        .pool-container {
            margin-top: 20px; width: 95%; max-width: 450px;
            background: rgba(255, 255, 255, 0.05); border-radius: 20px; padding: 15px;
            display: flex; flex-wrap: wrap; justify-content: center; gap: 12px;
        }

        .planet-slot { width: 50px; height: 50px; border-radius: 50%; background: rgba(0,0,0,0.3); }

        .planet { 
            width: 50px; height: 50px; position: absolute; 
            display: flex; flex-direction: column; align-items: center; z-index: 100;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.5));
        }
        
        .planet-img { 
            width: 100%; height: 100%; background-size: contain !important; 
            background-repeat: no-repeat !important; border-radius: 50%;
            /* ØªØ£Ø«ÙŠØ± ÙƒØ±ÙˆÙŠ Ø®ÙÙŠÙ */
            box-shadow: inset -5px -5px 10px rgba(0,0,0,0.4);
        }
        .planet span { font-size: 10px; margin-top: 4px; font-weight: bold; text-shadow: 0 2px 4px black; pointer-events: none; }
        
        .planet.returning { transition: all 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28); }

        #finish-modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95);
            display: none; justify-content: center; align-items: center; z-index: 8000;
        }
        .modal-content {
            background: #000; padding: 40px; border-radius: 30px; border: 1px solid var(--neon-blue);
            text-align: center; width: 85%; max-width: 350px;
        }

        .audio-controls { position: fixed; top: 15px; left: 15px; z-index: 8000; cursor: pointer; opacity: 0.7; }
    </style>
</head>
<body>

<div id="solar-flare-overlay"></div>

<div id="welcome-screen">
    <div id="astronaut-img">
        <img src="https://static.vecteezy.com/system/resources/previews/020/003/935/non_2x/astronaut-graphic-clipart-design-free-png.png" alt="astronaut">
    </div>
    <h1 id="welcome-text">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø£ÙŠÙ‡Ø§ Ø§Ù„Ù…Ø³ØªÙƒØ´Ù! Ù„Ù‚Ø¯ Ø­Ø¯Ø« Ø§Ù†ÙØ¬Ø§Ø± Ø´Ù…Ø³ÙŠ Ø¹Ù†ÙŠÙ ÙˆØªØ¨Ø¹Ø«Ø±Øª Ø§Ù„ÙƒÙˆØ§ÙƒØ¨. Ø³Ø§Ø¹Ø¯Ù†ÙŠ ÙÙŠ Ø¥Ø¹Ø§Ø¯ØªÙ‡Ø§ Ù„Ù…Ø¯Ø§Ø±Ø§ØªÙ‡Ø§!</h1>
    <button id="start-button">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ù‡Ù…Ø©!</button>
</div>

<div class="star-field">
    <div class="layer"></div><div class="layer"></div><div class="layer"></div>
</div>

<div class="audio-controls" onclick="toggleMusic()"><span id="mute-icon">ğŸ”‡</span></div>

<div id="game-content" style="display: none; width: 100%; flex-direction: column; align-items: center;">
    <div class="stats-bar">
        <span>Ø§Ù„ØªÙ‚Ø¯Ù…: <span id="percent-text">0%</span></span>
        <span>Ø§Ù„Ø²Ù…Ù†: <span id="timer-text">0</span> Ø«</span>
    </div>
    <div class="progress-container"><div id="progress-fill"></div></div>
    
    <div class="solar-system">
        <div class="sun"></div>
        <div class="drop-zone" data-order="1"></div>
        <div class="drop-zone" data-order="2"></div>
        <div class="drop-zone" data-order="3"></div>
        <div class="drop-zone" data-order="4"></div>
        <div class="drop-zone" data-order="5"></div>
        <div class="drop-zone" data-order="6"></div>
        <div class="drop-zone" data-order="7"></div>
        <div class="drop-zone" data-order="8"></div>
    </div>
    
    <div class="pool-container" id="pool"></div>
</div>

<div id="finish-modal">
    <div class="modal-content">
        <h2 style="color: var(--success)">ØªÙ…Øª Ø§Ù„Ù…Ù‡Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­! ğŸš€</h2>
        <p>Ù„Ù‚Ø¯ Ø£Ø¹Ø¯Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ù„Ù…Ø¬Ø±Ø© ÙÙŠ <span id="final-time">0</span> Ø«Ø§Ù†ÙŠØ©.</p>
        <button id="start-button" style="padding: 10px 30px; font-size: 0.9rem;" onclick="location.reload()">Ø§Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</button>
    </div>
</div>

<audio id="bg-music" loop src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-10.mp3"></audio>
<audio id="snd-correct" src="https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3"></audio>
<audio id="snd-wrong" src="https://assets.mixkit.co/active_storage/sfx/2021/2021-preview.mp3"></audio>

<script>
    const planetData = [
        { id: "1", name: "Ø¹Ø·Ø§Ø±Ø¯", img: "https://png.pngtree.com/png-clipart/20240416/original/pngtree-beautiful-planet-mercury-png-image_14861433.png" },
        { id: "2", name: "Ø§Ù„Ø²Ù‡Ø±Ø©", img: "https://static.vecteezy.com/system/resources/thumbnails/016/778/852/small/planet-galaxy-space-free-png.png" },
        { id: "3", name: "Ø§Ù„Ø£Ø±Ø¶", img: "https://www.nicepng.com/png/full/2-20644_earth-planet-globe-world-png-image-earth-with.png" },
        { id: "4", name: "Ø§Ù„Ù…Ø±ÙŠØ®", img: "https://pngimg.com/d/mars_planet_PNG5.png" },
        { id: "5", name: "Ø§Ù„Ù…Ø´ØªØ±ÙŠ", img: "https://pngimg.com/d/jupiter_PNG17.png" },
        { id: "6", name: "Ø²Ø­Ù„", img: "https://png.pngtree.com/png-vector/20240923/ourmid/pngtree-saturn-planet-image-isolated-on-white-background-png-image_13888938.png" },
        { id: "7", name: "Ø£ÙˆØ±Ø§Ù†ÙˆØ³", img: "https://static.vecteezy.com/system/resources/thumbnails/065/984/873/small/uranus-planet-space-isolated-on-transparent-background-png.png" },
        { id: "8", name: "Ù†Ø¨ØªÙˆÙ†", img: "https://png.pngtree.com/png-clipart/20230927/original/pngtree-neptune-planet-illustration-png-image_13139478.png" }
    ];

    let correctCount = 0, seconds = 0, timerActive = false, timerInterval;
    const bgMusic = document.getElementById('bg-music');

    function playSfx(id) {
        const s = document.getElementById(id);
        if(s) { s.currentTime = 0; s.play().catch(()=>{}); }
    }

    function toggleMusic() {
        if (bgMusic.paused) { bgMusic.play(); document.getElementById('mute-icon').textContent = "ğŸ”Š"; }
        else { bgMusic.pause(); document.getElementById('mute-icon').textContent = "ğŸ”‡"; }
    }

    function repositionAll() {
        document.querySelectorAll('.planet').forEach(p => {
            if (p.dataset.solved !== 'true') {
                const slot = document.getElementById('slot-' + p.id);
                const rect = slot.getBoundingClientRect();
                p.style.left = rect.left + 'px'; p.style.top = rect.top + 'px';
                p.dataset.homeLeft = rect.left; p.dataset.homeTop = rect.top;
            } else {
                const zone = document.querySelector(`.drop-zone[data-order="${p.id}"]`);
                const zr = zone.getBoundingClientRect();
                p.style.left = zr.left + (zr.width - p.offsetWidth)/2 + "px";
                p.style.top = zr.top + (zr.height - p.offsetHeight)/2 + "px";
            }
        });
    }

    document.getElementById('start-button').addEventListener('click', function() {
        const flare = document.getElementById('solar-flare-overlay');
        flare.style.opacity = '1'; // Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ù†ÙØ¬Ø§Ø±
        
        setTimeout(() => {
            document.getElementById('welcome-screen').style.display = 'none';
            document.getElementById('game-content').style.display = 'flex';
            initGame();
            flare.style.opacity = '0'; // ØªØ±Ø§Ø¬Ø¹ Ø§Ù„Ø§Ù†ÙØ¬Ø§Ø±
        }, 300);
    });

    function initGame() {
        const pool = document.getElementById('pool');
        [...planetData].sort(() => Math.random() - 0.5).forEach(data => {
            const slot = document.createElement('div');
            slot.className = 'planet-slot'; slot.id = 'slot-' + data.id;
            pool.appendChild(slot);

            const p = document.createElement('div');
            p.className = 'planet'; p.id = data.id;
            p.innerHTML = `<div class="planet-img" style="background: url(${data.img})"></div><span>${data.name}</span>`;
            document.body.appendChild(p);
            makeDraggable(p);
        });
        setTimeout(repositionAll, 100);
    }

    function makeDraggable(el) {
        let startX, startY;
        const start = (e) => {
            if(el.dataset.solved === 'true') return;
            if(!timerActive) {
                timerActive = true;
                bgMusic.play().catch(()=>{});
                document.getElementById('mute-icon').textContent = "ğŸ”Š";
                timerInterval = setInterval(() => { seconds++; document.getElementById('timer-text').textContent = seconds; }, 1000);
            }
            el.classList.remove('returning');
            const ev = e.touches ? e.touches[0] : e;
            startX = ev.clientX - el.offsetLeft; startY = ev.clientY - el.offsetTop;
            document.onmousemove = move; document.ontouchmove = move;
            document.onmouseup = end; document.ontouchend = end;
            el.style.zIndex = 1000;
        };
        const move = (e) => {
            const ev = e.touches ? e.touches[0] : e;
            el.style.left = (ev.clientX - startX) + "px";
            el.style.top = (ev.clientY - startY) + "px";
            // ÙƒØ´Ù Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù‚Ø±ÙŠØ¨Ø©
            const r = el.getBoundingClientRect();
            const cx = r.left + r.width/2, cy = r.top + r.height/2;
            document.querySelectorAll('.drop-zone').forEach(z => {
                const zr = z.getBoundingClientRect();
                if (cx > zr.left && cx < zr.right && cy > zr.top && cy < zr.bottom) z.classList.add('detecting');
                else z.classList.remove('detecting');
            });
        };
        const end = () => {
            document.onmousemove = document.ontouchmove = document.onmouseup = document.ontouchend = null;
            const r = el.getBoundingClientRect();
            const cx = r.left + r.width/2, cy = r.top + r.height/2;
            let targetZone = null;
            document.querySelectorAll('.drop-zone').forEach(z => {
                z.classList.remove('detecting');
                const zr = z.getBoundingClientRect();
                if (cx > zr.left && cx < zr.right && cy > zr.top && cy < zr.bottom) targetZone = z;
            });

            if (targetZone && el.id === targetZone.dataset.order) {
                el.dataset.solved = 'true';
                const zr = targetZone.getBoundingClientRect();
                el.style.left = zr.left + (zr.width - el.offsetWidth)/2 + "px";
                el.style.top = zr.top + (zr.height - el.offsetHeight)/2 + "px";
                playSfx('snd-correct');
                correctCount++;
                document.getElementById('progress-fill').style.width = (correctCount/8)*100 + "%";
                document.getElementById('percent-text').textContent = Math.round((correctCount/8)*100) + "%";
                if(correctCount === 8) {
                    clearInterval(timerInterval);
                    document.getElementById('final-time').textContent = seconds;
                    setTimeout(() => { document.getElementById('finish-modal').style.display = 'flex'; }, 500);
                }
            } else {
                if(targetZone) playSfx('snd-wrong');
                el.classList.add('returning');
                el.style.left = el.dataset.homeLeft + 'px';
                el.style.top = el.dataset.homeTop + 'px';
            }
        };
        el.onmousedown = start; el.ontouchstart = start;
    }

    window.addEventListener('resize', repositionAll);
</script>
</body>
</html>